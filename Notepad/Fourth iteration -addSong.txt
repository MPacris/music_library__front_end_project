Fourth Iteration - AddSongForm 


import React, { useState, useEffect } from 'react';
import axios from 'axios';
import MusicTable from './MusicTable/MusicTable';
import SearchBar from './SearchBar/SearchBar';
import Filter from './Filter/Filter';
import AddSongForm from './AddSongForm/AddSongForm';

function App() {
  const [songs, setSongs] = useState([]);
  const [filteredSongs, setFilteredSongs] = useState([]);

  useEffect(() => {
    fetchData();
  }, []);

  async function fetchData() {
    try {
      const response = await axios.get('http://127.0.0.1:5000/api/songs');
      setSongs(response.data.songs);
      setFilteredSongs(response.data.songs);
    } catch (ex) {
      console.log('Error in fetchData API call!');
    }
  }

  function handleSearch(term) {
    const filtered = songs.filter((song) => {
      const searchTerm = term.toLowerCase();
      return (
        song.title.toLowerCase().includes(searchTerm) ||
        song.album.toLowerCase().includes(searchTerm) ||
        song.artist.toLowerCase().includes(searchTerm) ||
        song.genre.toLowerCase().includes(searchTerm) ||
        song.release_date.toLowerCase().includes(searchTerm) ||
        song.running_time.toLowerCase().includes(searchTerm)
      );
    });
    setFilteredSongs(filtered);
  }

  function handleFilter(filterType, filterValue) {
    const filtered = songs.filter((song) => {
      const lowerCaseFilterValue = filterValue.toLowerCase();
      const filterChoices = {
        album: song.album.toLowerCase(),
        artist: song.artist.toLowerCase(),
        genre: song.genre.toLowerCase(),
        releaseDate: song.release_date.toLowerCase(),
        runningTime: song.running_time.toString(),
        title: song.title.toLowerCase()
      };
  
      if (filterType in filterChoices) {
        return filterChoices[filterType].includes(lowerCaseFilterValue);
      } else {
        return true;
      }
    });
  
    setFilteredSongs(filtered);
  }

  async function addSong(songData) {
    try {
      const response = await axios.post('http://127.0.0.1:5000/api/songs', songData);
      setSongs([...songs, response.data.song]);
      setFilteredSongs([...filteredSongs, response.data.song]);  //put in so that if I was filtering I can still add from that page
    } catch (ex) {
      console.log('Error in addSong API call!');
    }
  }

  return (
    <div>
      <h3>Music Library</h3>
      <SearchBar onSearch={handleSearch} />
      <Filter onFilter={handleFilter} />
      <MusicTable songs={filteredSongs} />
      <AddSongForm onAddSong={addSong} />
    </div>
  );
}

export default App;

import React, { useState } from 'react';
import axios from 'axios';

function AddSongForm({ onAddSong }) {
  const [title, setTitle] = useState('');
  const [album, setAlbum] = useState('');
  const [artist, setArtist] = useState('');
  const [genre, setGenre] = useState('');
  const [releaseDate, setReleaseDate] = useState('');
  const [runningTime, setRunningTime] = useState('');

  async function handleSubmit(event) {
    event.preventDefault();
    try {
      const response = await axios.post('http://127.0.0.1:5000/api/songs', {
        title,
        album,
        artist,
        genre,
        release_date: releaseDate,
        running_time: runningTime,
      });
      const newSong = response.data;
      onAddSong(newSong);
      setTitle('');
      setAlbum('');
      setArtist('');
      setGenre('');
      setReleaseDate('');
      setRunningTime('');
    } catch (ex) {
      console.log('Error in add song API call!', ex);
    }
  }

  return (
    <form onSubmit={handleSubmit}>
      <input
        type="text"
        placeholder="Title"
        value={title}
        onChange={(event) => setTitle(event.target.value)}
        required
      />
      <input
        type="text"
        placeholder="Album"
        value={album}
        onChange={(event) => setAlbum(event.target.value)}
      
      />
      <input
        type="text"
        placeholder="Artist"
        value={artist}
        onChange={(event) => setArtist(event.target.value)}
        required
      />
      <input
        type="text"
        placeholder="Genre"
        value={genre}
        onChange={(event) => setGenre(event.target.value)}
        
      />
      <input
        type="text"
        placeholder="Release Date (yyyy-mm-dd)"
        pattern="\d{4}-\d{2}-\d{2}"
        value={releaseDate}
        onChange={(event) => setReleaseDate(event.target.value)}
        
      />
      <input
        type="text"
        placeholder="Running Time"
        value={runningTime}
        onChange={(event) => setRunningTime(event.target.value)}
        
      />
      <button type="submit">Add Song</button>
    </form>
  );
}

export default AddSongForm;

import React, { useState } from 'react';

function Filter({ onFilter }) {
  const [filterType, setFilterType] = useState('');
  const [filterValue, setFilterValue] = useState('');

  function handleSubmit(event) {
    event.preventDefault();
    onFilter(filterType, filterValue);
  }

  return (
    <form onSubmit={handleSubmit}>
      <select value={filterType} onChange={(event) => setFilterType(event.target.value)}>
        <option value="">Select Filter Type</option>
        <option value="album">Album</option>
        <option value="artist">Artist</option>
        <option value="genre">Genre</option>
        <option value="releaseDate">Release Date</option>
        <option value="title">Title</option>
      </select>
      <input
        type="text"
        placeholder="Filter Value"
        value={filterValue}
        onChange={(event) => setFilterValue(event.target.value)}
        required
      />
      <button type="submit">Apply Filter</button>
    </form>
  );
}

export default Filter;

import React, { useState } from 'react';

function SearchBar({ onSearch }) {
  const [term, setTerm] = useState('');

  function handleSubmit(event) {
    event.preventDefault();
    onSearch(term);
  }

  return (
    <form onSubmit={handleSubmit}>
      <input
        type="text"
        placeholder="Search..."
        value={term}
        onChange={(event) => setTerm(event.target.value)}
      />
      <button type="submit">Search</button>
    </form>
  );
}

export default SearchBar;

import React from 'react';

function MusicTable({ songs }) {
  return (
    <table>
      <thead>
        <tr>
          <th>Title</th>
          <th>Album</th>
          <th>Artist</th>
          <th>Genre</th>
          <th>Release Date</th>
          <th>Running Time</th>
        </tr>
      </thead>
      <tbody>
        {songs.map((song) => (
          <tr key={song.id}>
            <td>{song.title}</td>
            <td>{song.album}</td>
            <td>{song.artist}</td>
            <td>{song.genre}</td>
            <td>{song.release_date}</td>
            <td>{song.running_time}</td>
          </tr>
        ))}
      </tbody>
    </table>
  );
}

export default MusicTable;